/* ======= Imports：沿用你的共用樣式 ======= */
@use "./background" as *;
@use "./buttons" as *;

/* ======= Root：尺寸與字級 ======= */
:root{
  /* 版心 */
  --kh-max-w: 760px;

  /* 卡片：預設走「行動版**寫死**尺寸」 */
  --card-w: 360px;
  --card-h: 440px;

  /* 固定三行所占的垂直比例（總和=100%） */
  --fs-pos: clamp(12px, 2.2vmin, 18px);   /* 詞性：最小 */
  --fs-zh:  clamp(16px, 3.2vmin, 28px);   /* 中文：中等 */
  --fs-en:  clamp(22px, 6.0vmin, 56px);   /* 英文：最大 */

  /* 每個區塊允許的行數，避免文字把版位撐開 */
  --lines-pos: 1;
  --lines-en:  2;
  --lines-zh:  2;

  /* 卡片寬高比，確保高度穩定（可依喜好微調） */
  --card-aspect: 3/4;

  --card-radius: 18px;
  --card-pad: 22px;

  --kh-pad-x: clamp(12px, 4vw, 20px);
  --kh-gap: clamp(12px, 3.6vw, 16px);

  --card-shadow: 0 10px 30px rgba(0,0,0,.45);
  --card-border: 1px solid rgba(255,255,255,.08);
}

/* ======= 基礎布局 ======= */
* { box-sizing: border-box; }
html, body { width: 100%; max-width: 100%; }
.vocab-body { overflow-x: hidden; }
.kh-main { min-height: 100svh; } /* 讓桌機視覺吃滿視窗高度 */

.vocab-container{
  width: 100%;
  max-width: var(--kh-max-w);
  margin-inline: auto;
  padding: calc(var(--kh-gap) + 4px) var(--kh-pad-x) var(--kh-gap);
  display: grid;
  gap: var(--kh-gap);
  justify-items: center;
}

/* ======= 搜尋 ======= */
.search-wrap{
  width: 100%;
  display: grid;
  gap: 8px;

  #search{
    width: 100%;
    height: 44px;
    border-radius: 999px;
    padding: 0 16px;
    outline: none;
    border: 1px solid rgba(255,255,255,.12);
    background: rgba(255,255,255,.06);
    color: #fff;
    backdrop-filter: blur(6px);
  }

  .suggestions{
    width: 100%;
    max-height: 40vh;
    overflow: auto;
    list-style: none;
    margin: 0;
    padding: 6px;
    border-radius: 12px;
    border: 1px solid rgba(255,255,255,.08);
    background: rgba(0,0,0,.35);
    display: none;

    &.show { display: block; }
    li{
      padding: 10px 12px;
      border-radius: 8px;
      cursor: pointer;
      &:hover { background: rgba(255,255,255,.06); }
    }
  }
}

/* ======= 單字卡 ======= */
.flip-card{ width: 100%; display: grid; justify-items: center; aspect-ratio: var(--card-aspect);}

.card{
  position: relative;
  width: var(--card-w);       /* 寫死寬度 */
  height: var(--card-h);      /* 寫死高度 */
  padding: var(--card-pad);
  border-radius: var(--card-radius);
  border: var(--card-border);
  overflow: hidden;
  display: grid;
  place-items: center;
  background:
    radial-gradient(120% 100% at 0% 0%, rgba(98,0,255,.18), transparent 60%),
    radial-gradient(120% 100% at 100% 0%, rgba(0,200,255,.15), transparent 60%),
    rgba(20,20,24,.85);
  box-shadow: var(--card-shadow);
}

/* 角標與發音 */
.corner-index{
  position: absolute; top: 10px; left: 12px;
  font-size: 12px; opacity: .8; user-select: none;
}
.btn-tts{
  position: absolute; top: 8px; right: 10px;
  width: 30px; height: 30px; border-radius: 999px;
  display: grid; place-items: center; line-height: 1; font-size: 16px; padding: 0;
  background: rgba(255,255,255,.08);
  border: 1px solid rgba(255,255,255,.18);
  transition: transform .12s ease, background .2s ease;
  &:hover { transform: translateY(-1px) scale(1.03); background: rgba(255,255,255,.12); }
}

/* 面內容 */
.face{
  width: 100%;
  height: 100%;
  display: grid; place-items: center;
  gap: 0px; padding-inline: 6px;
  overflow-y: auto; overflow-x: hidden;
}
.face-hidden{ display: none !important; }  /* ← 雙面切換關鍵 */

.word-text{
  font-size: var(--fz-word);
  font-weight: 800;
  line-height: 1.08;
  text-wrap: balance;
  word-break: break-word;
  letter-spacing: .02em;
  margin: 0;
}
.pos-text{
  font-size: var(--fz-pos);
  opacity: .8;
  margin: 0;
}
.definition-text{
  font-size: var(--fz-def);
  line-height: 1.6;
  margin: 0;
  text-align: left;
  word-break: break-word;
  white-space: pre-wrap;
}

/* ======= 按鈕群 ======= */
.btn-group{
  width: 100%;
  display: grid;
  gap: var(--kh-gap);
  justify-items: center;

  .row-btns{
    width: 100%;
    display: grid;
    grid-template-columns: 52px 1fr 52px; /* ⬅️ 🎲 ➡️ */
    gap: var(--kh-gap);
    align-items: center;
  }

  .btn{ width: 100%; }
  .btn-nav{ min-width: 52px; height: 48px; padding: 0; border-radius: 999px; font-size: 18px; }
  .btn-wide, .btn-mode, .btn-home{ height: 48px; border-radius: 16px; font-weight: 700; }
}

/* ======= Header（一致外觀） ======= */
.kh-header{
  position: sticky; top: 0; z-index: 50;
  backdrop-filter: blur(8px);
  background: linear-gradient(180deg, rgba(0,0,0,.6), rgba(0,0,0,0));
  .kh-header__inner{
    max-width: min(960px, 94vw);
    margin-inline: auto;
    padding: 12px var(--kh-pad-x);
    display: grid; justify-items: center;
  }
  .kh-logo img{ height: 36px; display: block; }
}

/* ======= RWD：超小手機 ======= */
@media (max-width: 360px){
  :root{
    --card-w: 320px;
    --card-h: 420px;
    --fz-word: clamp(22px, 8.2vw, 36px);
  }
}

/* ======= RWD：桌機吃滿視窗 ======= */
@media (min-width: 1024px){
  :root{
    --kh-max-w: 1120px;
    --card-w: 560px;
    --card-h: 760px;
    --fz-word: clamp(32px, 5vw, 72px);
    --fz-pos:  clamp(14px, 1.6vw, 22px);
    --fz-def:  clamp(16px, 1.8vw, 22px);
  }
  .vocab-container{
    max-width: var(--kh-max-w);
    width: min(96vw, var(--kh-max-w));
    padding-left: clamp(16px, 2vw, 32px);
    padding-right: clamp(16px, 2vw, 32px);
  }
  .btn-group .row-btns{ grid-template-columns: 64px 1fr 64px; }
  .btn-tts{ width: 34px; height: 34px; }
}

/* ======= RWD：超大桌機（可選） ======= */
@media (min-width: 1440px){
  :root{ --kh-max-w: 1280px; --card-w: 620px; --card-h: 860px; }
}

/* 細節 */
::placeholder{ color: rgba(255,255,255,.6); }

/* ================== 覆蓋：卡片寬度對齊按鈕 + Footer 貼底 ================== */

/* 1) 全頁結構：Footer 永遠在底部 */
.kh-body{
  min-height: 100svh;          /* 滿視窗高 */
  display: flex;
  flex-direction: column;
}
.kh-main{ flex: 1; }           /* 主內容撐開剩餘空間 */
.kh-footer{ margin-top: auto; }/* 讓 footer 貼到底部 */

/* 2) 內容寬度鎖定：卡片 = 按鈕群（也可順便讓搜尋列同寬） */
:root{
  /* 用 content 寬度變數，預設就吃卡片固定寬 */
  --content-w: var(--card-w);
}

/* 卡片/按鈕/搜尋 都以同一個寬度呈現（置中） */
.vocab-container{ justify-items: center; }

.flip-card,
.btn-group,
.search-wrap{
  width: var(--content-w);
  max-width: none;
  margin-inline: auto;
}

/* 卡片本體也鎖成同寬，避免 100% 撐到容器 */
.card{
  width: var(--content-w) !important;
}

/* 3) 桌機段落仍可吃滿（你原本已設定 --card-w/--card-h；這裡同步 content 寬） */
@media (min-width: 1024px){
  :root{
    --content-w: var(--card-w); /* 桌機卡片放大時，按鈕/搜尋自動跟著放大 */
  }
}

/* 4) 超小手機也同步（依你原本的 --card-w） */
@media (max-width: 360px){
  :root{
    --content-w: var(--card-w);
  }
}



/* ================================
   Vocab 卡片：自適應字級 + 位置固定
   —— 只覆蓋必要的選擇器，其餘不動 ——
================================ */

/* 三行固定位置：詞性(上) → 英文(中) → 中文(下) */
.face .entry {
  display: grid;
  /* 依比例固定三行高度，可照喜好微調比例 */
  grid-template-rows: 18% 52% 30%;
  align-content: stretch;
  justify-items: center;
  text-align: center;
  height: 100%;
  gap: 0;               /* 位置固定，行間距設 0；留白靠各自 line-height */
  padding: 0 .75rem;    /* 不影響既有外觀的前提下，避免字貼邊 */
}

/* 明確鎖定每行所在的 grid 位置 */
.pos-text { grid-row: 1; }
.en-text  { grid-row: 2; }
.zh-text  { grid-row: 3; }

/* —— 動態字級（跟著螢幕變化）——
   使用 clamp(最小, 相對於視窗的比例, 最大)
   vmin 會同時考量寬與高，較穩健 */
.pos-text {
  font-size: clamp(12px, 2.2vmin, 18px);   /* 詞性：最小 */
  line-height: 1.1;
  font-weight: 600;
  opacity: .85;
}

.en-text {
  font-size: clamp(20px, 8vmin, 60px);     /* 英文：最大 */
  line-height: 1.15;
  font-weight: 800;
  word-break: break-word;                  /* 超長字不擠位 */
  hyphens: auto;
}

.zh-text {
  font-size: clamp(16px, 4vmin, 32px);   /* 中文：中等 */
  line-height: 1.25;
  font-weight: 600;
  word-break: break-word;
}

/* —— 限制行數，避免把版位撐開導致位置位移 —— */
.pos-text,
.en-text,
.zh-text {
  /* 在各自格子內置中 */
  place-self: center;

  /* 多行截斷（WebKit） */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  overflow: hidden;
  text-overflow: ellipsis;
}

.pos-text { -webkit-line-clamp: 1; }  /* 詞性只顯示一行 */
.en-text  { -webkit-line-clamp: 2; }  /* 英文預設兩行封頂 */
.zh-text  { -webkit-line-clamp: 2; }  /* 中文預設兩行封頂 */

/* —— 若你的現有樣式把 .face 隱藏／顯示，這裡不改 —— */
/* 僅確保內容填滿容器高度，以配合上方 grid */
.face { min-height: 100%; }  /* 不影響原有 card 尺寸設定 */
